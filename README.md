# AHCAgent

A standalone command-line tool for solving AtCoder Heuristic Contest (AHC) problems using an AlphaEvolve-inspired approach.

## ‚ú® Features

- Problem analysis and solution strategy development utilizing LLMs.
- Solution search and optimization based on evolutionary algorithms.
- Docker integration for C++ code compilation and execution.
- Interactive mode supporting a step-by-step problem-solving process.
- Workspace-based storage for managing progress and results for each problem.
- Flexible configuration management via YAML files.

## üõ†Ô∏è Installation

```bash
pip install ahc-agent
```

## üìã Requirements

- Python 3.8 or higher
- Docker (required for C++ code compilation and execution)
- LLM API Access (supports OpenAI, Anthropic, etc., via LiteLLM)
- **Note:** You need to set environment variables like `OPENAI_API_KEY` to use LLM features.

## üöÄ Quick Start

### 1\. Initialize a Project

Initializes a new AHC project for a specific contest.
Creates a project directory (named after the `CONTEST_ID` by default, or as specified by `--workspace`)
and a configuration file (`config.yaml`) within it.
This configuration file will store the `contest_id`, as well as default `template` and `docker_image` settings.
The command will also attempt to scrape the problem statement for the given `CONTEST_ID`.

```bash
ahc-agent init ahc001 --workspace ./my_ahc_project
```

- `CONTEST_ID`: (Required) The ID of the AtCoder Heuristic Contest (e.g., `ahc001`).
- `--workspace PATH` (`-w`): Specify the directory to create the project in.
  If not set, a directory named after the `CONTEST_ID` is created in the current location.
- `--html FILE_PATH`: Specify the path to a local HTML file containing the problem statement. If provided, the problem statement will be parsed from this file instead of being fetched from the AtCoder website. This is useful when you have the problem statement saved locally or when direct web access is unavailable or fails.

### 2\. Solve a Problem

The `solve` command is the primary tool for tackling an AHC problem within a prepared workspace.
**The workspace directory must contain `problem.md` (the problem statement) and `config.yaml` (the project configuration).**

There are three main ways to use the `solve` command:

*   **Full Automated Solve:** Runs the entire problem-solving pipeline automatically.
    ```bash
    ahc-agent solve <path/to/your_workspace_directory>
    ```
    If test case files (e.g., `test01.txt`, `test02.txt`) exist in the `tools/in` subdirectory of the workspace, they will be automatically used for evaluation. Otherwise, test cases will be generated by the LLM.

*   **Interactive Mode:** Launches a menu-driven interactive session that guides you step-by-step.
    ```bash
    ahc-agent solve <path/to/your_workspace_directory> --interactive
    ```
    or
    ```bash
    ahc-agent solve <path/to/your_workspace_directory> -i
    ```

*   **Step-by-Step Execution (CLI Subcommands):** Allows you to run individual stages of the problem-solving process directly from the command line. This provides finer control and is useful for debugging or focusing on specific parts of the solution pipeline.

#### Step-by-Step Execution Subcommands

These subcommands are run as `ahc-agent solve <workspace_dir> <subcommand> [options]`.

*   **`analyze`**: Analyzes the problem description (`problem.md`).
    ```bash
    ahc-agent solve <workspace_dir> analyze
    ```
    *Description*: Reads the problem statement, identifies constraints, input/output formats, and scoring metrics. Saves the analysis to `problem_analysis.json` in the workspace.

*   **`strategy`**: Develops a solution strategy based on the problem analysis.
    ```bash
    ahc-agent solve <workspace_dir> strategy
    ```
    *Description*: Uses the problem analysis to generate a high-level solution strategy. Requires `problem_analysis.json` to exist. Saves the strategy to `solution_strategy.json`.

*   **`testcases`**: Generates or loads test cases.
    ```bash
    ahc-agent solve <workspace_dir> testcases [options]
    ```
    *Description*: Prepares test cases for evaluating solutions. Requires `problem_analysis.json`.
    *Options*:
        *   `--load-tools`: (Flag) Attempt to load test cases from the `<workspace_dir>/tools/in/` directory.
        *   `--force-generate`: (Flag) Force generation of new test cases, even if `--load-tools` is specified and files are found.
        *   `--num-cases INTEGER`: Number of test cases to generate if generation occurs (default: 3).

*   **`initial`**: Generates an initial solution based on the problem analysis.
    ```bash
    ahc-agent solve <workspace_dir> initial
    ```
    *Description*: Creates a first-pass solution code. Requires `problem_analysis.json`. Saves the solution to the internal Knowledge Base.

*   **`evolve`**: Runs the evolutionary process to improve upon a solution.
    ```bash
    ahc-agent solve <workspace_dir> evolve [options]
    ```
    *Description*: Iteratively refines and improves solution code using an evolutionary algorithm. Requires `problem_analysis.json`, `solution_strategy.json`, and test cases (which it will attempt to prepare using default settings if not already available from a prior `testcases` step).
    *Options*:
        *   `--generations INTEGER`: Number of generations to run. Overrides config default.
        *   `--population INTEGER`: Population size. Overrides config default.
        *   `--time-limit INTEGER`: Time limit in seconds. Overrides config default.
        *   `--initial-code-path FILE_PATH`: Path to a file containing initial code to start the evolution from. Overrides default behavior of using solutions from the Knowledge Base or generating a new one.

#### Example Workflow for Step-by-Step Execution

This example demonstrates how you might use the subcommands sequentially:

```bash
# Ensure you have initialized your project first
# ahc-agent init your_contest_id --workspace ./your_workspace
cd ./your_workspace

# Step 1: Analyze the problem
ahc-agent solve . analyze

# Step 2: Develop a strategy
ahc-agent solve . strategy

# Step 3: Prepare test cases (e.g., load from tools/in, then generate if none found)
ahc-agent solve . testcases --load-tools --num-cases 5

# Step 4: Generate an initial solution
ahc-agent solve . initial

# Step 5: Run the evolutionary process with specific parameters
ahc-agent solve . evolve --generations 50 --population 20 --time-limit 1800
```

### 3\. Interactive Mode Details

When you run `ahc-agent solve <workspace_dir> --interactive`, you enter a menu-driven mode.
**The workspace directory must contain `problem.md` and `config.yaml`.**

Available commands in interactive mode:

- `analyze`: Execute problem analysis.
- `strategy`: Devise solution strategy.
- `testcases`: Generate/load test cases and create a score calculator.
- `initial`: Generate an initial solution.
- `evolve`: Run the evolutionary search process.
- `status`: Display current status (loaded analysis, strategy, test cases, etc.).
- `help`: Display this list of commands.
- `exit`: Exit interactive mode.

## ‚öôÔ∏è Configuration

Configuration is primarily managed by the `config.yaml` file within the workspace. Settings specified in this file will override the global default settings.

- **Workspace Configuration (`config.yaml`)**: These are project (workspace) specific settings. When the `init` command is executed, basic settings such as the contest ID are written to this file. Users can customize settings like the LLM model and Docker image by editing this file.
- **Default Configuration**: If a specific key is not present in `config.yaml`, or if the file itself does not exist (e.g., when manually preparing a workspace without running `init` before executing the `solve` command), the application's built-in default settings will be used.

Currently, the functionality to override detailed configuration values via command-line options or environment variables is limited.

## üìú License

[MIT](https://www.google.com/search?q=LICENSE)
